<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reading and Analyzing DataVolley Scouting Files • datavolley</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Reading and Analyzing DataVolley Scouting Files">
<meta property="og:description" content="Provides basic functions for parsing Datavolley scouting files.
    Datavolley is a software package used for scouting and summarizing volleyball
    matches.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">datavolley</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="datavolley" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#datavolley" class="anchor"></a>datavolley</h1></div>

<p>An R package for reading DataVolley scouting files.</p>
<p>See also this <a href="https://apps.untan.gl/dvalidate/">DataVolley file validator</a>, which is built on the datavolley package.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"raymondben/datavolley"</span>)</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Read one of the example data files bundled with the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(datavolley)</a>
<a class="sourceLine" id="cb2-2" title="2">x &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_dv.html">read_dv</a></span>(<span class="kw"><a href="reference/dv_example_file.html">dv_example_file</a></span>(), <span class="dt">insert_technical_timeouts=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(x)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; Match summary:</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; Date: 2015-01-25</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; League: Finale mladinke</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; Teams: Braslovče (JERONČIČ ZORAN/MIHALINEC DAMIJANA)</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;        vs</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;        Nova KBM Branik (HAFNER MATJAŽ/)</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; Result: 3-0 (25-16, 25-14, 25-22)</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; Duration: 67 minutes</span></a></code></pre></div>
<p>Number of serves by team:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">serve_idx &lt;-<span class="st"> </span><span class="kw"><a href="reference/find_serves.html">find_serves</a></span>(<span class="kw"><a href="reference/plays.html">plays</a></span>(x))</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(<span class="kw"><a href="reference/plays.html">plays</a></span>(x)<span class="op">$</span>team[serve_idx])</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt;       Braslovče Nova KBM Branik </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt;              74              54</span></a></code></pre></div>
<p>Distribution of serve run lengths:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">serve_run_info &lt;-<span class="st"> </span><span class="kw"><a href="reference/find_runs.html">find_runs</a></span>(<span class="kw"><a href="reference/plays.html">plays</a></span>(x)[serve_idx,])</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(serve_run_info[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"run_id"</span>,<span class="st">"run_length"</span>)])<span class="op">$</span>run_length)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;  1  2  3  4  5  7  8 </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; 34 16  7  4  1  1  1</span></a></code></pre></div>
<p>The court position associated with each action can be recorded in two ways. The most common is by zones (numbered 1-9).</p>
<p>Heatmap of attack rate by court zone (where the attack was made from):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; Registered S3 methods overwritten by 'ggplot2':</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;   method         from </span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;   [.quosures     rlang</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;   c.quosures     rlang</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;   print.quosures rlang</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">## calculate attack frequency by zone, per team</span></a>
<a class="sourceLine" id="cb5-17" title="17">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="reference/plays.html">plays</a></span>(x) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(skill <span class="op">==</span><span class="st"> "Attack"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(team, start_zone) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">n_attacks=</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">rate=</span>n_attacks<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(n_attacks)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb5-20" title="20"></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">## add x,y coordinates associated with the zones</span></a>
<a class="sourceLine" id="cb5-22" title="22">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(attack_rate, <span class="kw"><a href="reference/dv_xy.html">dv_xy</a></span>(attack_rate<span class="op">$</span>start_zone, <span class="dt">end=</span><span class="st">"lower"</span>))</a>
<a class="sourceLine" id="cb5-23" title="23"></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">## for team 2, these need to be on the top half of the diagram</span></a>
<a class="sourceLine" id="cb5-25" title="25">tm2i &lt;-<span class="st"> </span>attack_rate<span class="op">$</span>team<span class="op">==</span><span class="kw"><a href="reference/teams.html">teams</a></span>(x)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-26" title="26">attack_rate[tm2i, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)] &lt;-<span class="st"> </span><span class="kw"><a href="reference/dv_flip_xy.html">dv_flip_xy</a></span>(attack_rate[tm2i, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)])</a>
<a class="sourceLine" id="cb5-27" title="27"></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(attack_rate, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y, <span class="dt">fill=</span>rate)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="dt">labels=</span><span class="kw"><a href="reference/teams.html">teams</a></span>(x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="dt">name=</span><span class="st">"Attack rate"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="700"></p>
<p>Heatmap of where attacks ended, using only attacks by Nova KBM Branik from position 4:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## calculate attack frequency by zone, per team</span></a>
<a class="sourceLine" id="cb6-2" title="2">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="reference/plays.html">plays</a></span>(x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(team <span class="op">==</span><span class="st"> "Nova KBM Branik"</span> <span class="op">&amp;</span><span class="st"> </span>skill <span class="op">==</span><span class="st"> "Attack"</span> <span class="op">&amp;</span><span class="st"> </span>start_zone <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(end_zone) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">n_attacks=</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">rate=</span>n_attacks<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(n_attacks)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb6-6" title="6">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(attack_rate, <span class="kw"><a href="reference/dv_xy.html">dv_xy</a></span>(attack_rate<span class="op">$</span>end_zone, <span class="dt">end=</span><span class="st">"lower"</span>))</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(attack_rate, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y, <span class="dt">fill=</span>rate)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="st">"lower"</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="dt">name=</span><span class="st">"Rate: attack</span><span class="ch">\n</span><span class="st">end location"</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_tile).</span></a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="700"></p>
<p>We can also use the end subzone information, if it has been recorded. The subzones divide each zone into four, so we get higher spatial resolution (but the subzone is not always scouted). The same plot as above, but using subzones:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="reference/plays.html">plays</a></span>(x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(team <span class="op">!=</span><span class="st"> "Nova KBM Branik"</span> <span class="op">&amp;</span><span class="st"> </span>skill <span class="op">==</span><span class="st"> "Attack"</span> <span class="op">&amp;</span><span class="st"> </span>start_zone <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(end_subzone)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(end_zone, end_subzone) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">n_attacks=</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">rate=</span>n_attacks<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(n_attacks)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb7-5" title="5">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(attack_rate, <span class="kw"><a href="reference/dv_xy.html">dv_xy</a></span>(attack_rate<span class="op">$</span>end_zone, <span class="dt">end=</span><span class="st">"lower"</span>, <span class="dt">subzones =</span> attack_rate<span class="op">$</span>end_subzone))</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(attack_rate, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y, <span class="dt">fill=</span>rate)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="st">"lower"</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="dt">name=</span><span class="st">"Rate: attack</span><span class="ch">\n</span><span class="st">end location"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="700"></p>
<p>Or using arrows to show the starting and ending zones of attacks:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">## first tabulate attacks by starting and ending zone</span></a>
<a class="sourceLine" id="cb8-2" title="2">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="reference/plays.html">plays</a></span>(x) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(team<span class="op">==</span><span class="kw"><a href="reference/teams.html">teams</a></span>(x)[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>skill<span class="op">==</span><span class="st">"Attack"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(start_zone, end_zone) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">tally</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">## convert counts to rates</span></a>
<a class="sourceLine" id="cb8-6" title="6">attack_rate<span class="op">$</span>rate &lt;-<span class="st"> </span>attack_rate<span class="op">$</span>n<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(attack_rate<span class="op">$</span>n)</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">## discard zones with zero attacks or missing location information</span></a>
<a class="sourceLine" id="cb8-9" title="9">attack_rate &lt;-<span class="st"> </span>attack_rate <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(rate<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(start_zone) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(end_zone))</a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">## add starting x,y coordinates</span></a>
<a class="sourceLine" id="cb8-12" title="12">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(attack_rate, <span class="kw"><a href="reference/dv_xy.html">dv_xy</a></span>(attack_rate<span class="op">$</span>start_zone, <span class="dt">end=</span><span class="st">"lower"</span>, <span class="dt">xynames=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"sx"</span>,<span class="st">"sy"</span>)))</a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">## and ending x,y coordinates</span></a>
<a class="sourceLine" id="cb8-15" title="15">attack_rate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(attack_rate, <span class="kw"><a href="reference/dv_xy.html">dv_xy</a></span>(attack_rate<span class="op">$</span>end_zone, <span class="dt">end=</span><span class="st">"upper"</span>, <span class="dt">xynames=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ex"</span>,<span class="st">"ey"</span>)))</a>
<a class="sourceLine" id="cb8-16" title="16"></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">## plot in reverse order so largest arrows are on the bottom</span></a>
<a class="sourceLine" id="cb8-18" title="18">attack_rate &lt;-<span class="st"> </span>attack_rate <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(rate))</a>
<a class="sourceLine" id="cb8-19" title="19"></a>
<a class="sourceLine" id="cb8-20" title="20">p &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(attack_rate,<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x,y,<span class="dt">col=</span>rate)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="reference/teams.html">teams</a></span>(x)[<span class="dv">1</span>],<span class="st">""</span>))</a>
<a class="sourceLine" id="cb8-21" title="21"><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(attack_rate))</a>
<a class="sourceLine" id="cb8-22" title="22">    p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(attack_rate<span class="op">$</span>sx[n], attack_rate<span class="op">$</span>ex[n]),</a>
<a class="sourceLine" id="cb8-23" title="23">                                       <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(attack_rate<span class="op">$</span>sy[n],attack_rate<span class="op">$</span>ey[n]),</a>
<a class="sourceLine" id="cb8-24" title="24">                                       <span class="dt">rate=</span>attack_rate<span class="op">$</span>rate[n]),</a>
<a class="sourceLine" id="cb8-25" title="25">        <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">size=</span>rate), <span class="dt">lineend=</span><span class="st">"round"</span>, <span class="dt">arrow=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">arrow</a></span>(<span class="dt">ends=</span><span class="st">"last"</span>, <span class="dt">type=</span><span class="st">"closed"</span>))</a>
<a class="sourceLine" id="cb8-26" title="26">p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span>(<span class="dt">name=</span><span class="st">"Attack rate"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">size=</span><span class="st">"none"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="700"></p>
<p>The second source of position data is court coordinates. These are not included in all data files, because generally they must be manually entered by the scout and this can be a time consuming process. For the purposes of demonstration, here we generate fake coordinate data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co">## take just the serves from the play-by-play data</span></a>
<a class="sourceLine" id="cb9-2" title="2">xserves &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset</a></span>(<span class="kw"><a href="reference/plays.html">plays</a></span>(x), skill<span class="op">==</span><span class="st">"Serve"</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">## if the file had been scouted with coordinate included, we could plot them directly</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">## this file has no coordinates, so we'll fake some up for demo purposes</span></a>
<a class="sourceLine" id="cb9-6" title="6">coords &lt;-<span class="st"> </span><span class="kw"><a href="reference/dv_fake_coordinates.html">dv_fake_coordinates</a></span>(<span class="st">"serve"</span>, xserves<span class="op">$</span>evaluation)</a>
<a class="sourceLine" id="cb9-7" title="7">xserves[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"start_coordinate"</span>, <span class="st">"start_coordinate_x"</span>, <span class="st">"start_coordinate_y"</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">            <span class="st">"end_coordinate"</span>, <span class="st">"end_coordinate_x"</span>, <span class="st">"end_coordinate_y"</span>)] &lt;-<span class="st"> </span>coords</a>
<a class="sourceLine" id="cb9-9" title="9"></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">## now we can plot these</span></a>
<a class="sourceLine" id="cb9-11" title="11">xserves<span class="op">$</span>evaluation[<span class="op">!</span>xserves<span class="op">$</span>evaluation <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Ace"</span>, <span class="st">"Error"</span>)] &lt;-<span class="st"> "Other"</span></a>
<a class="sourceLine" id="cb9-12" title="12"></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(xserves, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(start_coordinate_x, start_coordinate_y,</a>
<a class="sourceLine" id="cb9-14" title="14">       <span class="dt">xend=</span>end_coordinate_x, <span class="dt">yend=</span>end_coordinate_y, <span class="dt">colour=</span>evaluation))<span class="op">+</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span>(<span class="dt">values=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">Ace=</span><span class="st">"limegreen"</span>, <span class="dt">Error=</span><span class="st">"firebrick"</span>, <span class="dt">Other=</span><span class="st">"dodgerblue"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="st">    </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="dt">labels=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Serving team"</span>, <span class="st">"Receiving team"</span>))</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="700"></p>
<p>We could also use these coordinates to generate a heatmap-style plot of serve location:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(xserves, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(start_coordinate_x, start_coordinate_y))<span class="op">+</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html">stat_density_2d</a></span>(<span class="dt">geom=</span><span class="st">"raster"</span>, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>..density..), <span class="dt">contour=</span><span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span>(<span class="dt">palette=</span><span class="dv">1</span>, <span class="dt">direction=</span><span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">    </span><span class="kw"><a href="reference/ggcourt.html">ggcourt</a></span>(<span class="st">"lower"</span>, <span class="dt">labels=</span><span class="st">"Serving team"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>Troubleshooting</h2>
<p>If you see unexpected behaviour, try <code><a href="reference/read_dv.html">read_dv(...,do_warn=TRUE)</a></code> to obtain more diagnostic information during the process of reading and parsing the DataVolley file. Also check the text encoding specified to <code>read_dv</code> (did you specify one??)</p>
</div>
<div id="more" class="section level2">
<h2 class="hasAnchor">
<a href="#more" class="anchor"></a>More</h2>
<p>For more information about DataVolley, see <a href="http://www.dataproject.com/IT/en/Volleyball" class="uri">http://www.dataproject.com/IT/en/Volleyball</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Ben Raymond <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/raymondben/datavolley"><img src="https://travis-ci.org/raymondben/datavolley.svg?branch=master" alt="Travis-CI Build Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ben Raymond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
